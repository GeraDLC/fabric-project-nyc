{"name":"df_pres_processing_nyctaxi","ppdf:dataflowId":"16353f59-a80c-428d-8d95-1c9d7978b4c6","ppdf:owner":{"tenantId":"7240c382-77f3-42ea-9576-37097db362d0","userId":"3f818326-426b-4a7c-baa8-16b11e271193"},"ppdf:fastCopy":true,"version":"1.0","culture":"es-ES","modifiedTime":"2025-04-08T21:15:13.9810056+00:00","ppdf:outputFileFormat":"Parquet","pbi:mashup":{"fastCombine":false,"allowNativeQueries":true,"queriesMetadata":{"stg nyctaxi_yellow":{"queryId":"d1124b94-da2a-4d4b-a674-046a3ee3585a","queryName":"stg nyctaxi_yellow","loadEnabled":true},"stg taxi_zone_lookup":{"queryId":"dc1a7118-851a-431c-ab60-4c476405c1e9","queryName":"stg taxi_zone_lookup","loadEnabled":true},"Combinar":{"queryId":"b3642f97-7479-420f-a82f-398319ab592a","queryName":"Combinar","loadEnabled":true},"Combinar (2)":{"queryId":"a88ff5dd-138b-4d08-be29-326de3f584f9","queryName":"Combinar (2)","loadEnabled":true},"Combinar (2)_DataDestination":{"queryId":"c7f1ac41-c1e1-4cfb-a3c9-18b4b78a7046","queryName":"Combinar (2)_DataDestination"},"Combinar (2)_WriteToDataDestination":{"queryId":"3f02be34-9a51-4706-84bc-cc7f3ae03195","queryName":"Combinar (2)_WriteToDataDestination"},"Combinar (2)_TransformForWriteToDataDestination":{"queryId":"afd6036a-ec43-4a02-9765-1c1a4a3a84ca","queryName":"Combinar (2)_TransformForWriteToDataDestination"},"FastCopyStaging":{"queryId":"06b62cad-eb90-4540-8063-9dcfcb03c6e3","queryName":"FastCopyStaging"}},"document":"section Section1;\r\nshared #\"stg nyctaxi_yellow\" = let\r\n  Origen = Fabric.Warehouse(null),\r\n  Navegación = Origen{[workspaceId = \"eaeb229f-ff18-43f5-b13c-d48378b321dd\"]}[Data],\r\n  #\"Navegación 1\" = Navegación{[warehouseId = \"8dd0b1bc-dde3-4aa0-a4a2-2d4043f7cd13\"]}[Data],\r\n  #\"Navegación 2\" = #\"Navegación 1\"{[Schema = \"stg\", Item = \"nyctaxi_yellow\"]}[Data],\r\n  #\"Columnas quitadas\" = Table.RemoveColumns(#\"Navegación 2\", {\"RatecodeID\", \"store_and_fwd_flag\", \"fare_amount\", \"extra\", \"mta_tax\", \"tip_amount\", \"tolls_amount\", \"improvement_surcharge\", \"congestion_surcharge\", \"Airport_fee\"}),\r\n  #\"Columna condicional insertada\" = Table.AddColumn(#\"Columnas quitadas\", \"vendor\", each if [VendorID] = 1 then \"Creative Mobile Tech\" else if [VendorID] = 2 then \"VeriFone\" else \"Uknown\"),\r\n  #\"Columnas reordenadas\" = Table.ReorderColumns(#\"Columna condicional insertada\", {\"vendor\", \"VendorID\", \"tpep_pickup_datetime\", \"tpep_dropoff_datetime\", \"passenger_count\", \"trip_distance\", \"PULocationID\", \"DOLocationID\", \"payment_type\", \"total_amount\"}),\r\n  #\"Columnas quitadas 1\" = Table.RemoveColumns(#\"Columnas reordenadas\", {\"VendorID\"}),\r\n  #\"Columna condicional insertada 1\" = Table.AddColumn(#\"Columnas quitadas 1\", \"payment_method\", each if [payment_type] = 1 then \"Credit Card\" else if [payment_type] = 2 then \"Cash\" else if [payment_type] = 3 then \"No Charge\" else if [payment_type] = 4 then \"Dispute\" else if [payment_type] = 5 then \"Unknown\" else if [payment_type] = 6 then \"Voided Trip\" else \"Unknown\"),\r\n  #\"Columnas quitadas 2\" = Table.RemoveColumns(#\"Columna condicional insertada 1\", {\"payment_type\"}),\r\n  #\"Columnas reordenadas 1\" = Table.ReorderColumns(#\"Columnas quitadas 2\", {\"vendor\", \"tpep_pickup_datetime\", \"tpep_dropoff_datetime\", \"passenger_count\", \"trip_distance\", \"PULocationID\", \"DOLocationID\", \"payment_method\", \"total_amount\"}),\r\n  #\"Columnas con nombre cambiado\" = Table.RenameColumns(#\"Columnas reordenadas 1\", {{\"PULocationID\", \"pu_location_id\"}, {\"DOLocationID\", \"do_location_id\"}}),\r\n  #\"Fecha calculada\" = Table.TransformColumns(#\"Columnas con nombre cambiado\", {{\"tpep_pickup_datetime\", each DateTime.Date(_), type nullable date}, {\"tpep_dropoff_datetime\", each DateTime.Date(_), type nullable date}}),\r\n  #\"Tipo de columna cambiado\" = Table.TransformColumnTypes(#\"Fecha calculada\", {{\"vendor\", type text}, {\"payment_method\", type text}})\r\nin\r\n  #\"Tipo de columna cambiado\";\r\nshared #\"stg taxi_zone_lookup\" = let\r\n  Origen = Fabric.Warehouse(null),\r\n  Navegación = Origen{[workspaceId = \"eaeb229f-ff18-43f5-b13c-d48378b321dd\"]}[Data],\r\n  #\"Navegación 1\" = Navegación{[warehouseId = \"8dd0b1bc-dde3-4aa0-a4a2-2d4043f7cd13\"]}[Data],\r\n  #\"Navegación 2\" = #\"Navegación 1\"{[Schema = \"stg\", Item = \"taxi_zone_lookup\"]}[Data],\r\n  #\"Tipo de columna cambiado\" = Table.TransformColumnTypes(#\"Navegación 2\", {{\"LocationID\", Int64.Type}})\r\nin\r\n  #\"Tipo de columna cambiado\";\r\nshared Combinar = let\r\n  Origen = Table.NestedJoin(#\"stg nyctaxi_yellow\", {\"pu_location_id\"}, #\"stg taxi_zone_lookup\", {\"LocationID\"}, \"stg taxi_zone_lookup\", JoinKind.LeftOuter),\r\n  #\"stg taxi_zone_lookup expandido\" = Table.ExpandTableColumn(Origen, \"stg taxi_zone_lookup\", {\"Borough\", \"Zone\"}, {\"Borough\", \"Zone\"}),\r\n  #\"Columnas reordenadas\" = Table.ReorderColumns(#\"stg taxi_zone_lookup expandido\", {\"vendor\", \"tpep_pickup_datetime\", \"tpep_dropoff_datetime\", \"passenger_count\", \"trip_distance\", \"pu_location_id\", \"Borough\", \"Zone\", \"do_location_id\", \"payment_method\", \"total_amount\"}),\r\n  #\"Columnas con nombre cambiado\" = Table.RenameColumns(#\"Columnas reordenadas\", {{\"Borough\", \"pu_borough\"}, {\"Zone\", \"pu_zone\"}}),\r\n  #\"Columnas quitadas\" = Table.RemoveColumns(#\"Columnas con nombre cambiado\", {\"pu_location_id\"})\r\nin\r\n  #\"Columnas quitadas\";\r\n[Staging = \"FastCopyStaging\"]\r\nshared #\"Combinar (2)\" = let\r\n  Origen = Table.NestedJoin(Combinar, {\"do_location_id\"}, #\"stg taxi_zone_lookup\", {\"LocationID\"}, \"stg taxi_zone_lookup\", JoinKind.LeftOuter),\r\n  #\"stg taxi_zone_lookup expandido\" = Table.ExpandTableColumn(Origen, \"stg taxi_zone_lookup\", {\"Borough\", \"Zone\"}, {\"Borough\", \"Zone\"}),\r\n  #\"Columnas reordenadas\" = Table.ReorderColumns(#\"stg taxi_zone_lookup expandido\", {\"vendor\", \"tpep_pickup_datetime\", \"tpep_dropoff_datetime\", \"passenger_count\", \"trip_distance\", \"pu_borough\", \"pu_zone\", \"do_location_id\", \"Borough\", \"Zone\", \"payment_method\", \"total_amount\"}),\r\n  #\"Columnas con nombre cambiado\" = Table.RenameColumns(#\"Columnas reordenadas\", {{\"Borough\", \"do_borough\"}, {\"Zone\", \"do_zone\"}}),\r\n  #\"Columnas quitadas\" = Table.RemoveColumns(#\"Columnas con nombre cambiado\", {\"do_location_id\"}),\r\n  #\"Columnas reordenadas 1\" = Table.ReorderColumns(#\"Columnas quitadas\", {\"vendor\", \"tpep_pickup_datetime\", \"tpep_dropoff_datetime\", \"pu_borough\", \"pu_zone\", \"do_zone\", \"do_borough\", \"payment_method\", \"passenger_count\", \"trip_distance\", \"total_amount\"})\r\nin\r\n  #\"Columnas reordenadas 1\";\r\nshared #\"Combinar (2)_DataDestination\" = let\r\n  Pattern = Fabric.Warehouse([CreateNavigationProperties = false]),\r\n  Navigation_1 = Pattern{[workspaceId = \"eaeb229f-ff18-43f5-b13c-d48378b321dd\"]}[Data],\r\n  Navigation_2 = Navigation_1{[warehouseId = \"8dd0b1bc-dde3-4aa0-a4a2-2d4043f7cd13\"]}[Data],\r\n  TableNavigation = Navigation_2{[Schema = \"dbo\", Item = \"nyctaxi_yellow\"]}[Data]\r\nin\r\n  TableNavigation;\r\nshared DefaultStaging = let\r\n  DefaultStaging = Pipeline.DefaultModelStorage()\r\nin\r\n  DefaultStaging;\r\n[Staging = \"FastCopyStaging\"]\r\nshared #\"Combinar (2)_WriteToDataDestination\" = let\r\n  #\"Combinar (2)_WriteToDataDestination\" = Pipeline.ExecuteAction(ValueAction.WithTransaction([Target = #\"Combinar (2)_DataDestination\"], (txn) => {TableAction.InsertRows(txn[Target], #\"Combinar (2)_TransformForWriteToDataDestination\"), Action.DoNothing}))\r\nin\r\n  #\"Combinar (2)_WriteToDataDestination\";\r\nshared #\"Combinar (2)_TransformForWriteToDataDestination\" = let\r\n    SourceTable = Table.SelectColumns(#\"Combinar (2)\", {\"vendor\", \"tpep_pickup_datetime\", \"tpep_dropoff_datetime\", \"pu_borough\", \"pu_zone\", \"do_borough\", \"do_zone\", \"passenger_count\", \"trip_distance\", \"total_amount\"})\r\nin\r\n    SourceTable;\r\nshared FastCopyStaging = let\r\n  FastCopyStaging = Pipeline.FastCopyModelStorage(DefaultStaging, [Required = false])\r\nin\r\n  FastCopyStaging;\r\n","connectionOverrides":[{"path":"Lakehouse","kind":"Lakehouse","provider":"CdsA","authenticationKind":null,"environmentName":null,"apiName":null,"connectionName":"{\"kind\":\"Lakehouse\",\"path\":\"Lakehouse\"}","audience":null},{"path":"Warehouse","kind":"Warehouse","provider":"CdsA","authenticationKind":null,"environmentName":null,"apiName":null,"connectionName":"{\"kind\":\"Warehouse\",\"path\":\"Warehouse\"}","audience":null}]},"entities":[{"$type":"LocalEntity","name":"stg nyctaxi_yellow","description":"","pbi:refreshPolicy":{"$type":"FullRefreshPolicy","location":"stg%20nyctaxi_yellow.parquet"},"annotations":[{"name":"ppdf:entityKeys","value":"[]"}],"attributes":[{"name":"vendor","dataType":"string"},{"name":"tpep_pickup_datetime","dataType":"date"},{"name":"tpep_dropoff_datetime","dataType":"date"},{"name":"passenger_count","dataType":"int64"},{"name":"trip_distance","dataType":"double"},{"name":"pu_location_id","dataType":"int64"},{"name":"do_location_id","dataType":"int64"},{"name":"payment_method","dataType":"string"},{"name":"total_amount","dataType":"double"}]},{"$type":"LocalEntity","name":"stg taxi_zone_lookup","description":"","pbi:refreshPolicy":{"$type":"FullRefreshPolicy","location":"stg%20taxi_zone_lookup.parquet"},"annotations":[{"name":"ppdf:entityKeys","value":"[]"}],"attributes":[{"name":"LocationID","dataType":"int64"},{"name":"Borough","dataType":"string"},{"name":"Zone","dataType":"string"},{"name":"service_zone","dataType":"string"}]},{"$type":"LocalEntity","name":"Combinar","description":"","pbi:refreshPolicy":{"$type":"FullRefreshPolicy","location":"Combinar.parquet"},"annotations":[{"name":"pbi:EntityTypeDisplayHint","value":"CalculatedEntity"},{"name":"ppdf:entityKeys","value":"[]"}],"attributes":[{"name":"vendor","dataType":"string"},{"name":"tpep_pickup_datetime","dataType":"date"},{"name":"tpep_dropoff_datetime","dataType":"date"},{"name":"passenger_count","dataType":"int64"},{"name":"trip_distance","dataType":"double"},{"name":"pu_borough","dataType":"string"},{"name":"pu_zone","dataType":"string"},{"name":"do_location_id","dataType":"int64"},{"name":"payment_method","dataType":"string"},{"name":"total_amount","dataType":"double"}]},{"$type":"LocalEntity","name":"Combinar (2)","description":"","pbi:refreshPolicy":{"$type":"FullRefreshPolicy","location":"Combinar%20%282%29.parquet"},"annotations":[{"name":"pbi:EntityTypeDisplayHint","value":"CalculatedEntity"},{"name":"ppdf:entityKeys","value":"[]"}],"attributes":[{"name":"vendor","dataType":"string"},{"name":"tpep_pickup_datetime","dataType":"date"},{"name":"tpep_dropoff_datetime","dataType":"date"},{"name":"pu_borough","dataType":"string"},{"name":"pu_zone","dataType":"string"},{"name":"do_zone","dataType":"string"},{"name":"do_borough","dataType":"string"},{"name":"payment_method","dataType":"string"},{"name":"passenger_count","dataType":"int64"},{"name":"trip_distance","dataType":"double"},{"name":"total_amount","dataType":"double"}]}]}